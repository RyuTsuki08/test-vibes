"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/keyborg";
exports.ids = ["vendor-chunks/keyborg"];
exports.modules = {

/***/ "(ssr)/./node_modules/keyborg/dist/esm/index.js":
/*!************************************************!*\
  !*** ./node_modules/keyborg/dist/esm/index.js ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   KEYBORG_FOCUSIN: () => (/* binding */ KEYBORG_FOCUSIN),\n/* harmony export */   KEYBORG_FOCUSOUT: () => (/* binding */ KEYBORG_FOCUSOUT),\n/* harmony export */   createKeyborg: () => (/* binding */ createKeyborg),\n/* harmony export */   disposeKeyborg: () => (/* binding */ disposeKeyborg),\n/* harmony export */   getLastFocusedProgrammatically: () => (/* binding */ getLastFocusedProgrammatically),\n/* harmony export */   nativeFocus: () => (/* binding */ nativeFocus),\n/* harmony export */   version: () => (/* binding */ version)\n/* harmony export */ });\n// src/WeakRefInstance.ts\nvar _canUseWeakRef = typeof WeakRef !== \"undefined\";\nvar WeakRefInstance = class {\n  constructor(instance) {\n    if (_canUseWeakRef && typeof instance === \"object\") {\n      this._weakRef = new WeakRef(instance);\n    } else {\n      this._instance = instance;\n    }\n  }\n  /**\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakRef/deref}\n   */\n  deref() {\n    var _a, _b;\n    let instance;\n    if (this._weakRef) {\n      instance = (_a = this._weakRef) == null ? void 0 : _a.deref();\n      if (!instance) {\n        delete this._weakRef;\n      }\n    } else {\n      instance = this._instance;\n      if ((_b = instance == null ? void 0 : instance.isDisposed) == null ? void 0 : _b.call(instance)) {\n        delete this._instance;\n      }\n    }\n    return instance;\n  }\n};\n\n// src/FocusEvent.ts\nvar KEYBORG_FOCUSIN = \"keyborg:focusin\";\nvar KEYBORG_FOCUSOUT = \"keyborg:focusout\";\nfunction canOverrideNativeFocus(win) {\n  const HTMLElement = win.HTMLElement;\n  const origFocus = HTMLElement.prototype.focus;\n  let isCustomFocusCalled = false;\n  HTMLElement.prototype.focus = function focus() {\n    isCustomFocusCalled = true;\n  };\n  const btn = win.document.createElement(\"button\");\n  btn.focus();\n  HTMLElement.prototype.focus = origFocus;\n  return isCustomFocusCalled;\n}\nvar _canOverrideNativeFocus = false;\nfunction nativeFocus(element) {\n  const focus = element.focus;\n  if (focus.__keyborgNativeFocus) {\n    focus.__keyborgNativeFocus.call(element);\n  } else {\n    element.focus();\n  }\n}\nfunction setupFocusEvent(win) {\n  const kwin = win;\n  if (!_canOverrideNativeFocus) {\n    _canOverrideNativeFocus = canOverrideNativeFocus(kwin);\n  }\n  const origFocus = kwin.HTMLElement.prototype.focus;\n  if (origFocus.__keyborgNativeFocus) {\n    return;\n  }\n  kwin.HTMLElement.prototype.focus = focus;\n  const shadowTargets = /* @__PURE__ */ new Set();\n  const focusOutHandler = (e) => {\n    const target = e.target;\n    if (!target) {\n      return;\n    }\n    const event = new CustomEvent(KEYBORG_FOCUSOUT, {\n      cancelable: true,\n      bubbles: true,\n      // Allows the event to bubble past an open shadow root\n      composed: true,\n      detail: {\n        originalEvent: e\n      }\n    });\n    target.dispatchEvent(event);\n  };\n  const focusInHandler = (e) => {\n    const target = e.target;\n    if (!target) {\n      return;\n    }\n    let node = e.composedPath()[0];\n    const currentShadows = /* @__PURE__ */ new Set();\n    while (node) {\n      if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n        currentShadows.add(node);\n        node = node.host;\n      } else {\n        node = node.parentNode;\n      }\n    }\n    for (const shadowRootWeakRef of shadowTargets) {\n      const shadowRoot = shadowRootWeakRef.deref();\n      if (!shadowRoot || !currentShadows.has(shadowRoot)) {\n        shadowTargets.delete(shadowRootWeakRef);\n        if (shadowRoot) {\n          shadowRoot.removeEventListener(\"focusin\", focusInHandler, true);\n          shadowRoot.removeEventListener(\"focusout\", focusOutHandler, true);\n        }\n      }\n    }\n    onFocusIn(target, e.relatedTarget || void 0);\n  };\n  const onFocusIn = (target, relatedTarget, originalEvent) => {\n    var _a;\n    const shadowRoot = target.shadowRoot;\n    if (shadowRoot) {\n      for (const shadowRootWeakRef of shadowTargets) {\n        if (shadowRootWeakRef.deref() === shadowRoot) {\n          return;\n        }\n      }\n      shadowRoot.addEventListener(\"focusin\", focusInHandler, true);\n      shadowRoot.addEventListener(\"focusout\", focusOutHandler, true);\n      shadowTargets.add(new WeakRefInstance(shadowRoot));\n      return;\n    }\n    const details = {\n      relatedTarget,\n      originalEvent\n    };\n    const event = new CustomEvent(KEYBORG_FOCUSIN, {\n      cancelable: true,\n      bubbles: true,\n      // Allows the event to bubble past an open shadow root\n      composed: true,\n      detail: details\n    });\n    event.details = details;\n    if (_canOverrideNativeFocus || data.lastFocusedProgrammatically) {\n      details.isFocusedProgrammatically = target === ((_a = data.lastFocusedProgrammatically) == null ? void 0 : _a.deref());\n      data.lastFocusedProgrammatically = void 0;\n    }\n    target.dispatchEvent(event);\n  };\n  const data = kwin.__keyborgData = {\n    focusInHandler,\n    focusOutHandler,\n    shadowTargets\n  };\n  kwin.document.addEventListener(\n    \"focusin\",\n    kwin.__keyborgData.focusInHandler,\n    true\n  );\n  kwin.document.addEventListener(\n    \"focusout\",\n    kwin.__keyborgData.focusOutHandler,\n    true\n  );\n  function focus() {\n    const keyborgNativeFocusEvent = kwin.__keyborgData;\n    if (keyborgNativeFocusEvent) {\n      keyborgNativeFocusEvent.lastFocusedProgrammatically = new WeakRefInstance(\n        this\n      );\n    }\n    return origFocus.apply(this, arguments);\n  }\n  let activeElement = kwin.document.activeElement;\n  while (activeElement && activeElement.shadowRoot) {\n    onFocusIn(activeElement);\n    activeElement = activeElement.shadowRoot.activeElement;\n  }\n  focus.__keyborgNativeFocus = origFocus;\n}\nfunction disposeFocusEvent(win) {\n  const kwin = win;\n  const proto = kwin.HTMLElement.prototype;\n  const origFocus = proto.focus.__keyborgNativeFocus;\n  const keyborgNativeFocusEvent = kwin.__keyborgData;\n  if (keyborgNativeFocusEvent) {\n    kwin.document.removeEventListener(\n      \"focusin\",\n      keyborgNativeFocusEvent.focusInHandler,\n      true\n    );\n    kwin.document.removeEventListener(\n      \"focusout\",\n      keyborgNativeFocusEvent.focusOutHandler,\n      true\n    );\n    for (const shadowRootWeakRef of keyborgNativeFocusEvent.shadowTargets) {\n      const shadowRoot = shadowRootWeakRef.deref();\n      if (shadowRoot) {\n        shadowRoot.removeEventListener(\n          \"focusin\",\n          keyborgNativeFocusEvent.focusInHandler,\n          true\n        );\n        shadowRoot.removeEventListener(\n          \"focusout\",\n          keyborgNativeFocusEvent.focusOutHandler,\n          true\n        );\n      }\n    }\n    keyborgNativeFocusEvent.shadowTargets.clear();\n    delete kwin.__keyborgData;\n  }\n  if (origFocus) {\n    proto.focus = origFocus;\n  }\n}\nfunction getLastFocusedProgrammatically(win) {\n  var _a;\n  const keyborgNativeFocusEvent = win.__keyborgData;\n  return keyborgNativeFocusEvent ? ((_a = keyborgNativeFocusEvent.lastFocusedProgrammatically) == null ? void 0 : _a.deref()) || null : void 0;\n}\n\n// src/Keyborg.ts\nvar _dismissTimeout = 500;\nvar _lastId = 0;\nvar KeyborgCore = class {\n  constructor(win, props) {\n    this._isNavigatingWithKeyboard_DO_NOT_USE = false;\n    this._onFocusIn = (e) => {\n      if (this._isMouseOrTouchUsedTimer) {\n        return;\n      }\n      if (this.isNavigatingWithKeyboard) {\n        return;\n      }\n      const details = e.detail;\n      if (!details.relatedTarget) {\n        return;\n      }\n      if (details.isFocusedProgrammatically || details.isFocusedProgrammatically === void 0) {\n        return;\n      }\n      this.isNavigatingWithKeyboard = true;\n    };\n    this._onMouseDown = (e) => {\n      if (e.buttons === 0 || e.clientX === 0 && e.clientY === 0 && e.screenX === 0 && e.screenY === 0) {\n        return;\n      }\n      this._onMouseOrTouch();\n    };\n    this._onMouseOrTouch = () => {\n      const win = this._win;\n      if (win) {\n        if (this._isMouseOrTouchUsedTimer) {\n          win.clearTimeout(this._isMouseOrTouchUsedTimer);\n        }\n        this._isMouseOrTouchUsedTimer = win.setTimeout(() => {\n          delete this._isMouseOrTouchUsedTimer;\n        }, 1e3);\n      }\n      this.isNavigatingWithKeyboard = false;\n    };\n    this._onKeyDown = (e) => {\n      const isNavigatingWithKeyboard = this.isNavigatingWithKeyboard;\n      if (isNavigatingWithKeyboard) {\n        if (this._shouldDismissKeyboardNavigation(e)) {\n          this._scheduleDismiss();\n        }\n      } else {\n        if (this._shouldTriggerKeyboardNavigation(e)) {\n          this.isNavigatingWithKeyboard = true;\n        }\n      }\n    };\n    this.id = \"c\" + ++_lastId;\n    this._win = win;\n    const doc = win.document;\n    if (props) {\n      const triggerKeys = props.triggerKeys;\n      const dismissKeys = props.dismissKeys;\n      if (triggerKeys == null ? void 0 : triggerKeys.length) {\n        this._triggerKeys = new Set(triggerKeys);\n      }\n      if (dismissKeys == null ? void 0 : dismissKeys.length) {\n        this._dismissKeys = new Set(dismissKeys);\n      }\n    }\n    doc.addEventListener(KEYBORG_FOCUSIN, this._onFocusIn, true);\n    doc.addEventListener(\"mousedown\", this._onMouseDown, true);\n    win.addEventListener(\"keydown\", this._onKeyDown, true);\n    doc.addEventListener(\"touchstart\", this._onMouseOrTouch, true);\n    doc.addEventListener(\"touchend\", this._onMouseOrTouch, true);\n    doc.addEventListener(\"touchcancel\", this._onMouseOrTouch, true);\n    setupFocusEvent(win);\n  }\n  get isNavigatingWithKeyboard() {\n    return this._isNavigatingWithKeyboard_DO_NOT_USE;\n  }\n  set isNavigatingWithKeyboard(val) {\n    if (this._isNavigatingWithKeyboard_DO_NOT_USE !== val) {\n      this._isNavigatingWithKeyboard_DO_NOT_USE = val;\n      this.update();\n    }\n  }\n  dispose() {\n    const win = this._win;\n    if (win) {\n      if (this._isMouseOrTouchUsedTimer) {\n        win.clearTimeout(this._isMouseOrTouchUsedTimer);\n        this._isMouseOrTouchUsedTimer = void 0;\n      }\n      if (this._dismissTimer) {\n        win.clearTimeout(this._dismissTimer);\n        this._dismissTimer = void 0;\n      }\n      disposeFocusEvent(win);\n      const doc = win.document;\n      doc.removeEventListener(KEYBORG_FOCUSIN, this._onFocusIn, true);\n      doc.removeEventListener(\"mousedown\", this._onMouseDown, true);\n      win.removeEventListener(\"keydown\", this._onKeyDown, true);\n      doc.removeEventListener(\"touchstart\", this._onMouseOrTouch, true);\n      doc.removeEventListener(\"touchend\", this._onMouseOrTouch, true);\n      doc.removeEventListener(\"touchcancel\", this._onMouseOrTouch, true);\n      delete this._win;\n    }\n  }\n  isDisposed() {\n    return !!this._win;\n  }\n  /**\n   * Updates all keyborg instances with the keyboard navigation state\n   */\n  update() {\n    var _a, _b;\n    const keyborgs = (_b = (_a = this._win) == null ? void 0 : _a.__keyborg) == null ? void 0 : _b.refs;\n    if (keyborgs) {\n      for (const id of Object.keys(keyborgs)) {\n        Keyborg.update(keyborgs[id], this.isNavigatingWithKeyboard);\n      }\n    }\n  }\n  /**\n   * @returns whether the keyboard event should trigger keyboard navigation mode\n   */\n  _shouldTriggerKeyboardNavigation(e) {\n    var _a;\n    if (e.key === \"Tab\") {\n      return true;\n    }\n    const activeElement = (_a = this._win) == null ? void 0 : _a.document.activeElement;\n    const isTriggerKey = !this._triggerKeys || this._triggerKeys.has(e.keyCode);\n    const isEditable = activeElement && (activeElement.tagName === \"INPUT\" || activeElement.tagName === \"TEXTAREA\" || activeElement.isContentEditable);\n    return isTriggerKey && !isEditable;\n  }\n  /**\n   * @returns whether the keyboard event should dismiss keyboard navigation mode\n   */\n  _shouldDismissKeyboardNavigation(e) {\n    var _a;\n    return (_a = this._dismissKeys) == null ? void 0 : _a.has(e.keyCode);\n  }\n  _scheduleDismiss() {\n    const win = this._win;\n    if (win) {\n      if (this._dismissTimer) {\n        win.clearTimeout(this._dismissTimer);\n        this._dismissTimer = void 0;\n      }\n      const was = win.document.activeElement;\n      this._dismissTimer = win.setTimeout(() => {\n        this._dismissTimer = void 0;\n        const cur = win.document.activeElement;\n        if (was && cur && was === cur) {\n          this.isNavigatingWithKeyboard = false;\n        }\n      }, _dismissTimeout);\n    }\n  }\n};\nvar Keyborg = class _Keyborg {\n  constructor(win, props) {\n    this._cb = [];\n    this._id = \"k\" + ++_lastId;\n    this._win = win;\n    const current = win.__keyborg;\n    if (current) {\n      this._core = current.core;\n      current.refs[this._id] = this;\n    } else {\n      this._core = new KeyborgCore(win, props);\n      win.__keyborg = {\n        core: this._core,\n        refs: { [this._id]: this }\n      };\n    }\n  }\n  static create(win, props) {\n    return new _Keyborg(win, props);\n  }\n  static dispose(instance) {\n    instance.dispose();\n  }\n  /**\n   * Updates all subscribed callbacks with the keyboard navigation state\n   */\n  static update(instance, isNavigatingWithKeyboard) {\n    instance._cb.forEach((callback) => callback(isNavigatingWithKeyboard));\n  }\n  dispose() {\n    var _a;\n    const current = (_a = this._win) == null ? void 0 : _a.__keyborg;\n    if (current == null ? void 0 : current.refs[this._id]) {\n      delete current.refs[this._id];\n      if (Object.keys(current.refs).length === 0) {\n        current.core.dispose();\n        delete this._win.__keyborg;\n      }\n    } else if (true) {\n      console.error(\n        `Keyborg instance ${this._id} is being disposed incorrectly.`\n      );\n    }\n    this._cb = [];\n    delete this._core;\n    delete this._win;\n  }\n  /**\n   * @returns Whether the user is navigating with keyboard\n   */\n  isNavigatingWithKeyboard() {\n    var _a;\n    return !!((_a = this._core) == null ? void 0 : _a.isNavigatingWithKeyboard);\n  }\n  /**\n   * @param callback - Called when the keyboard navigation state changes\n   */\n  subscribe(callback) {\n    this._cb.push(callback);\n  }\n  /**\n   * @param callback - Registered with subscribe\n   */\n  unsubscribe(callback) {\n    const index = this._cb.indexOf(callback);\n    if (index >= 0) {\n      this._cb.splice(index, 1);\n    }\n  }\n  /**\n   * Manually set the keyboard navigtion state\n   */\n  setVal(isNavigatingWithKeyboard) {\n    if (this._core) {\n      this._core.isNavigatingWithKeyboard = isNavigatingWithKeyboard;\n    }\n  }\n};\nfunction createKeyborg(win, props) {\n  return Keyborg.create(win, props);\n}\nfunction disposeKeyborg(instance) {\n  Keyborg.dispose(instance);\n}\n\n// src/index.ts\nvar version = \"2.6.0\";\n\n/*!\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMva2V5Ym9yZy9kaXN0L2VzbS9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sU0FBUyxJQUFxQztBQUNwRDtBQUNBLDRCQUE0QixVQUFVO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFTRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWIvLi9ub2RlX21vZHVsZXMva2V5Ym9yZy9kaXN0L2VzbS9pbmRleC5qcz8yMTQwIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9XZWFrUmVmSW5zdGFuY2UudHNcbnZhciBfY2FuVXNlV2Vha1JlZiA9IHR5cGVvZiBXZWFrUmVmICE9PSBcInVuZGVmaW5lZFwiO1xudmFyIFdlYWtSZWZJbnN0YW5jZSA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoaW5zdGFuY2UpIHtcbiAgICBpZiAoX2NhblVzZVdlYWtSZWYgJiYgdHlwZW9mIGluc3RhbmNlID09PSBcIm9iamVjdFwiKSB7XG4gICAgICB0aGlzLl93ZWFrUmVmID0gbmV3IFdlYWtSZWYoaW5zdGFuY2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9pbnN0YW5jZSA9IGluc3RhbmNlO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvV2Vha1JlZi9kZXJlZn1cbiAgICovXG4gIGRlcmVmKCkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgbGV0IGluc3RhbmNlO1xuICAgIGlmICh0aGlzLl93ZWFrUmVmKSB7XG4gICAgICBpbnN0YW5jZSA9IChfYSA9IHRoaXMuX3dlYWtSZWYpID09IG51bGwgPyB2b2lkIDAgOiBfYS5kZXJlZigpO1xuICAgICAgaWYgKCFpbnN0YW5jZSkge1xuICAgICAgICBkZWxldGUgdGhpcy5fd2Vha1JlZjtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaW5zdGFuY2UgPSB0aGlzLl9pbnN0YW5jZTtcbiAgICAgIGlmICgoX2IgPSBpbnN0YW5jZSA9PSBudWxsID8gdm9pZCAwIDogaW5zdGFuY2UuaXNEaXNwb3NlZCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9iLmNhbGwoaW5zdGFuY2UpKSB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLl9pbnN0YW5jZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGluc3RhbmNlO1xuICB9XG59O1xuXG4vLyBzcmMvRm9jdXNFdmVudC50c1xudmFyIEtFWUJPUkdfRk9DVVNJTiA9IFwia2V5Ym9yZzpmb2N1c2luXCI7XG52YXIgS0VZQk9SR19GT0NVU09VVCA9IFwia2V5Ym9yZzpmb2N1c291dFwiO1xuZnVuY3Rpb24gY2FuT3ZlcnJpZGVOYXRpdmVGb2N1cyh3aW4pIHtcbiAgY29uc3QgSFRNTEVsZW1lbnQgPSB3aW4uSFRNTEVsZW1lbnQ7XG4gIGNvbnN0IG9yaWdGb2N1cyA9IEhUTUxFbGVtZW50LnByb3RvdHlwZS5mb2N1cztcbiAgbGV0IGlzQ3VzdG9tRm9jdXNDYWxsZWQgPSBmYWxzZTtcbiAgSFRNTEVsZW1lbnQucHJvdG90eXBlLmZvY3VzID0gZnVuY3Rpb24gZm9jdXMoKSB7XG4gICAgaXNDdXN0b21Gb2N1c0NhbGxlZCA9IHRydWU7XG4gIH07XG4gIGNvbnN0IGJ0biA9IHdpbi5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICBidG4uZm9jdXMoKTtcbiAgSFRNTEVsZW1lbnQucHJvdG90eXBlLmZvY3VzID0gb3JpZ0ZvY3VzO1xuICByZXR1cm4gaXNDdXN0b21Gb2N1c0NhbGxlZDtcbn1cbnZhciBfY2FuT3ZlcnJpZGVOYXRpdmVGb2N1cyA9IGZhbHNlO1xuZnVuY3Rpb24gbmF0aXZlRm9jdXMoZWxlbWVudCkge1xuICBjb25zdCBmb2N1cyA9IGVsZW1lbnQuZm9jdXM7XG4gIGlmIChmb2N1cy5fX2tleWJvcmdOYXRpdmVGb2N1cykge1xuICAgIGZvY3VzLl9fa2V5Ym9yZ05hdGl2ZUZvY3VzLmNhbGwoZWxlbWVudCk7XG4gIH0gZWxzZSB7XG4gICAgZWxlbWVudC5mb2N1cygpO1xuICB9XG59XG5mdW5jdGlvbiBzZXR1cEZvY3VzRXZlbnQod2luKSB7XG4gIGNvbnN0IGt3aW4gPSB3aW47XG4gIGlmICghX2Nhbk92ZXJyaWRlTmF0aXZlRm9jdXMpIHtcbiAgICBfY2FuT3ZlcnJpZGVOYXRpdmVGb2N1cyA9IGNhbk92ZXJyaWRlTmF0aXZlRm9jdXMoa3dpbik7XG4gIH1cbiAgY29uc3Qgb3JpZ0ZvY3VzID0ga3dpbi5IVE1MRWxlbWVudC5wcm90b3R5cGUuZm9jdXM7XG4gIGlmIChvcmlnRm9jdXMuX19rZXlib3JnTmF0aXZlRm9jdXMpIHtcbiAgICByZXR1cm47XG4gIH1cbiAga3dpbi5IVE1MRWxlbWVudC5wcm90b3R5cGUuZm9jdXMgPSBmb2N1cztcbiAgY29uc3Qgc2hhZG93VGFyZ2V0cyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7XG4gIGNvbnN0IGZvY3VzT3V0SGFuZGxlciA9IChlKSA9PiB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoS0VZQk9SR19GT0NVU09VVCwge1xuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgICAvLyBBbGxvd3MgdGhlIGV2ZW50IHRvIGJ1YmJsZSBwYXN0IGFuIG9wZW4gc2hhZG93IHJvb3RcbiAgICAgIGNvbXBvc2VkOiB0cnVlLFxuICAgICAgZGV0YWlsOiB7XG4gICAgICAgIG9yaWdpbmFsRXZlbnQ6IGVcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0YXJnZXQuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gIH07XG4gIGNvbnN0IGZvY3VzSW5IYW5kbGVyID0gKGUpID0+IHtcbiAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICBpZiAoIXRhcmdldCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBsZXQgbm9kZSA9IGUuY29tcG9zZWRQYXRoKClbMF07XG4gICAgY29uc3QgY3VycmVudFNoYWRvd3MgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICAgIHdoaWxlIChub2RlKSB7XG4gICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5ET0NVTUVOVF9GUkFHTUVOVF9OT0RFKSB7XG4gICAgICAgIGN1cnJlbnRTaGFkb3dzLmFkZChub2RlKTtcbiAgICAgICAgbm9kZSA9IG5vZGUuaG9zdDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAoY29uc3Qgc2hhZG93Um9vdFdlYWtSZWYgb2Ygc2hhZG93VGFyZ2V0cykge1xuICAgICAgY29uc3Qgc2hhZG93Um9vdCA9IHNoYWRvd1Jvb3RXZWFrUmVmLmRlcmVmKCk7XG4gICAgICBpZiAoIXNoYWRvd1Jvb3QgfHwgIWN1cnJlbnRTaGFkb3dzLmhhcyhzaGFkb3dSb290KSkge1xuICAgICAgICBzaGFkb3dUYXJnZXRzLmRlbGV0ZShzaGFkb3dSb290V2Vha1JlZik7XG4gICAgICAgIGlmIChzaGFkb3dSb290KSB7XG4gICAgICAgICAgc2hhZG93Um9vdC5yZW1vdmVFdmVudExpc3RlbmVyKFwiZm9jdXNpblwiLCBmb2N1c0luSGFuZGxlciwgdHJ1ZSk7XG4gICAgICAgICAgc2hhZG93Um9vdC5yZW1vdmVFdmVudExpc3RlbmVyKFwiZm9jdXNvdXRcIiwgZm9jdXNPdXRIYW5kbGVyLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBvbkZvY3VzSW4odGFyZ2V0LCBlLnJlbGF0ZWRUYXJnZXQgfHwgdm9pZCAwKTtcbiAgfTtcbiAgY29uc3Qgb25Gb2N1c0luID0gKHRhcmdldCwgcmVsYXRlZFRhcmdldCwgb3JpZ2luYWxFdmVudCkgPT4ge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBzaGFkb3dSb290ID0gdGFyZ2V0LnNoYWRvd1Jvb3Q7XG4gICAgaWYgKHNoYWRvd1Jvb3QpIHtcbiAgICAgIGZvciAoY29uc3Qgc2hhZG93Um9vdFdlYWtSZWYgb2Ygc2hhZG93VGFyZ2V0cykge1xuICAgICAgICBpZiAoc2hhZG93Um9vdFdlYWtSZWYuZGVyZWYoKSA9PT0gc2hhZG93Um9vdCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgc2hhZG93Um9vdC5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNpblwiLCBmb2N1c0luSGFuZGxlciwgdHJ1ZSk7XG4gICAgICBzaGFkb3dSb290LmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c291dFwiLCBmb2N1c091dEhhbmRsZXIsIHRydWUpO1xuICAgICAgc2hhZG93VGFyZ2V0cy5hZGQobmV3IFdlYWtSZWZJbnN0YW5jZShzaGFkb3dSb290KSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGRldGFpbHMgPSB7XG4gICAgICByZWxhdGVkVGFyZ2V0LFxuICAgICAgb3JpZ2luYWxFdmVudFxuICAgIH07XG4gICAgY29uc3QgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoS0VZQk9SR19GT0NVU0lOLCB7XG4gICAgICBjYW5jZWxhYmxlOiB0cnVlLFxuICAgICAgYnViYmxlczogdHJ1ZSxcbiAgICAgIC8vIEFsbG93cyB0aGUgZXZlbnQgdG8gYnViYmxlIHBhc3QgYW4gb3BlbiBzaGFkb3cgcm9vdFxuICAgICAgY29tcG9zZWQ6IHRydWUsXG4gICAgICBkZXRhaWw6IGRldGFpbHNcbiAgICB9KTtcbiAgICBldmVudC5kZXRhaWxzID0gZGV0YWlscztcbiAgICBpZiAoX2Nhbk92ZXJyaWRlTmF0aXZlRm9jdXMgfHwgZGF0YS5sYXN0Rm9jdXNlZFByb2dyYW1tYXRpY2FsbHkpIHtcbiAgICAgIGRldGFpbHMuaXNGb2N1c2VkUHJvZ3JhbW1hdGljYWxseSA9IHRhcmdldCA9PT0gKChfYSA9IGRhdGEubGFzdEZvY3VzZWRQcm9ncmFtbWF0aWNhbGx5KSA9PSBudWxsID8gdm9pZCAwIDogX2EuZGVyZWYoKSk7XG4gICAgICBkYXRhLmxhc3RGb2N1c2VkUHJvZ3JhbW1hdGljYWxseSA9IHZvaWQgMDtcbiAgICB9XG4gICAgdGFyZ2V0LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICB9O1xuICBjb25zdCBkYXRhID0ga3dpbi5fX2tleWJvcmdEYXRhID0ge1xuICAgIGZvY3VzSW5IYW5kbGVyLFxuICAgIGZvY3VzT3V0SGFuZGxlcixcbiAgICBzaGFkb3dUYXJnZXRzXG4gIH07XG4gIGt3aW4uZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICBcImZvY3VzaW5cIixcbiAgICBrd2luLl9fa2V5Ym9yZ0RhdGEuZm9jdXNJbkhhbmRsZXIsXG4gICAgdHJ1ZVxuICApO1xuICBrd2luLmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgXCJmb2N1c291dFwiLFxuICAgIGt3aW4uX19rZXlib3JnRGF0YS5mb2N1c091dEhhbmRsZXIsXG4gICAgdHJ1ZVxuICApO1xuICBmdW5jdGlvbiBmb2N1cygpIHtcbiAgICBjb25zdCBrZXlib3JnTmF0aXZlRm9jdXNFdmVudCA9IGt3aW4uX19rZXlib3JnRGF0YTtcbiAgICBpZiAoa2V5Ym9yZ05hdGl2ZUZvY3VzRXZlbnQpIHtcbiAgICAgIGtleWJvcmdOYXRpdmVGb2N1c0V2ZW50Lmxhc3RGb2N1c2VkUHJvZ3JhbW1hdGljYWxseSA9IG5ldyBXZWFrUmVmSW5zdGFuY2UoXG4gICAgICAgIHRoaXNcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBvcmlnRm9jdXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuICBsZXQgYWN0aXZlRWxlbWVudCA9IGt3aW4uZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgd2hpbGUgKGFjdGl2ZUVsZW1lbnQgJiYgYWN0aXZlRWxlbWVudC5zaGFkb3dSb290KSB7XG4gICAgb25Gb2N1c0luKGFjdGl2ZUVsZW1lbnQpO1xuICAgIGFjdGl2ZUVsZW1lbnQgPSBhY3RpdmVFbGVtZW50LnNoYWRvd1Jvb3QuYWN0aXZlRWxlbWVudDtcbiAgfVxuICBmb2N1cy5fX2tleWJvcmdOYXRpdmVGb2N1cyA9IG9yaWdGb2N1cztcbn1cbmZ1bmN0aW9uIGRpc3Bvc2VGb2N1c0V2ZW50KHdpbikge1xuICBjb25zdCBrd2luID0gd2luO1xuICBjb25zdCBwcm90byA9IGt3aW4uSFRNTEVsZW1lbnQucHJvdG90eXBlO1xuICBjb25zdCBvcmlnRm9jdXMgPSBwcm90by5mb2N1cy5fX2tleWJvcmdOYXRpdmVGb2N1cztcbiAgY29uc3Qga2V5Ym9yZ05hdGl2ZUZvY3VzRXZlbnQgPSBrd2luLl9fa2V5Ym9yZ0RhdGE7XG4gIGlmIChrZXlib3JnTmF0aXZlRm9jdXNFdmVudCkge1xuICAgIGt3aW4uZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgIFwiZm9jdXNpblwiLFxuICAgICAga2V5Ym9yZ05hdGl2ZUZvY3VzRXZlbnQuZm9jdXNJbkhhbmRsZXIsXG4gICAgICB0cnVlXG4gICAgKTtcbiAgICBrd2luLmRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICBcImZvY3Vzb3V0XCIsXG4gICAgICBrZXlib3JnTmF0aXZlRm9jdXNFdmVudC5mb2N1c091dEhhbmRsZXIsXG4gICAgICB0cnVlXG4gICAgKTtcbiAgICBmb3IgKGNvbnN0IHNoYWRvd1Jvb3RXZWFrUmVmIG9mIGtleWJvcmdOYXRpdmVGb2N1c0V2ZW50LnNoYWRvd1RhcmdldHMpIHtcbiAgICAgIGNvbnN0IHNoYWRvd1Jvb3QgPSBzaGFkb3dSb290V2Vha1JlZi5kZXJlZigpO1xuICAgICAgaWYgKHNoYWRvd1Jvb3QpIHtcbiAgICAgICAgc2hhZG93Um9vdC5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgICAgICAgIFwiZm9jdXNpblwiLFxuICAgICAgICAgIGtleWJvcmdOYXRpdmVGb2N1c0V2ZW50LmZvY3VzSW5IYW5kbGVyLFxuICAgICAgICAgIHRydWVcbiAgICAgICAgKTtcbiAgICAgICAgc2hhZG93Um9vdC5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgICAgICAgIFwiZm9jdXNvdXRcIixcbiAgICAgICAgICBrZXlib3JnTmF0aXZlRm9jdXNFdmVudC5mb2N1c091dEhhbmRsZXIsXG4gICAgICAgICAgdHJ1ZVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICBrZXlib3JnTmF0aXZlRm9jdXNFdmVudC5zaGFkb3dUYXJnZXRzLmNsZWFyKCk7XG4gICAgZGVsZXRlIGt3aW4uX19rZXlib3JnRGF0YTtcbiAgfVxuICBpZiAob3JpZ0ZvY3VzKSB7XG4gICAgcHJvdG8uZm9jdXMgPSBvcmlnRm9jdXM7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldExhc3RGb2N1c2VkUHJvZ3JhbW1hdGljYWxseSh3aW4pIHtcbiAgdmFyIF9hO1xuICBjb25zdCBrZXlib3JnTmF0aXZlRm9jdXNFdmVudCA9IHdpbi5fX2tleWJvcmdEYXRhO1xuICByZXR1cm4ga2V5Ym9yZ05hdGl2ZUZvY3VzRXZlbnQgPyAoKF9hID0ga2V5Ym9yZ05hdGl2ZUZvY3VzRXZlbnQubGFzdEZvY3VzZWRQcm9ncmFtbWF0aWNhbGx5KSA9PSBudWxsID8gdm9pZCAwIDogX2EuZGVyZWYoKSkgfHwgbnVsbCA6IHZvaWQgMDtcbn1cblxuLy8gc3JjL0tleWJvcmcudHNcbnZhciBfZGlzbWlzc1RpbWVvdXQgPSA1MDA7XG52YXIgX2xhc3RJZCA9IDA7XG52YXIgS2V5Ym9yZ0NvcmUgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHdpbiwgcHJvcHMpIHtcbiAgICB0aGlzLl9pc05hdmlnYXRpbmdXaXRoS2V5Ym9hcmRfRE9fTk9UX1VTRSA9IGZhbHNlO1xuICAgIHRoaXMuX29uRm9jdXNJbiA9IChlKSA9PiB7XG4gICAgICBpZiAodGhpcy5faXNNb3VzZU9yVG91Y2hVc2VkVGltZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuaXNOYXZpZ2F0aW5nV2l0aEtleWJvYXJkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGRldGFpbHMgPSBlLmRldGFpbDtcbiAgICAgIGlmICghZGV0YWlscy5yZWxhdGVkVGFyZ2V0KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChkZXRhaWxzLmlzRm9jdXNlZFByb2dyYW1tYXRpY2FsbHkgfHwgZGV0YWlscy5pc0ZvY3VzZWRQcm9ncmFtbWF0aWNhbGx5ID09PSB2b2lkIDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5pc05hdmlnYXRpbmdXaXRoS2V5Ym9hcmQgPSB0cnVlO1xuICAgIH07XG4gICAgdGhpcy5fb25Nb3VzZURvd24gPSAoZSkgPT4ge1xuICAgICAgaWYgKGUuYnV0dG9ucyA9PT0gMCB8fCBlLmNsaWVudFggPT09IDAgJiYgZS5jbGllbnRZID09PSAwICYmIGUuc2NyZWVuWCA9PT0gMCAmJiBlLnNjcmVlblkgPT09IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5fb25Nb3VzZU9yVG91Y2goKTtcbiAgICB9O1xuICAgIHRoaXMuX29uTW91c2VPclRvdWNoID0gKCkgPT4ge1xuICAgICAgY29uc3Qgd2luID0gdGhpcy5fd2luO1xuICAgICAgaWYgKHdpbikge1xuICAgICAgICBpZiAodGhpcy5faXNNb3VzZU9yVG91Y2hVc2VkVGltZXIpIHtcbiAgICAgICAgICB3aW4uY2xlYXJUaW1lb3V0KHRoaXMuX2lzTW91c2VPclRvdWNoVXNlZFRpbWVyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pc01vdXNlT3JUb3VjaFVzZWRUaW1lciA9IHdpbi5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBkZWxldGUgdGhpcy5faXNNb3VzZU9yVG91Y2hVc2VkVGltZXI7XG4gICAgICAgIH0sIDFlMyk7XG4gICAgICB9XG4gICAgICB0aGlzLmlzTmF2aWdhdGluZ1dpdGhLZXlib2FyZCA9IGZhbHNlO1xuICAgIH07XG4gICAgdGhpcy5fb25LZXlEb3duID0gKGUpID0+IHtcbiAgICAgIGNvbnN0IGlzTmF2aWdhdGluZ1dpdGhLZXlib2FyZCA9IHRoaXMuaXNOYXZpZ2F0aW5nV2l0aEtleWJvYXJkO1xuICAgICAgaWYgKGlzTmF2aWdhdGluZ1dpdGhLZXlib2FyZCkge1xuICAgICAgICBpZiAodGhpcy5fc2hvdWxkRGlzbWlzc0tleWJvYXJkTmF2aWdhdGlvbihlKSkge1xuICAgICAgICAgIHRoaXMuX3NjaGVkdWxlRGlzbWlzcygpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodGhpcy5fc2hvdWxkVHJpZ2dlcktleWJvYXJkTmF2aWdhdGlvbihlKSkge1xuICAgICAgICAgIHRoaXMuaXNOYXZpZ2F0aW5nV2l0aEtleWJvYXJkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5pZCA9IFwiY1wiICsgKytfbGFzdElkO1xuICAgIHRoaXMuX3dpbiA9IHdpbjtcbiAgICBjb25zdCBkb2MgPSB3aW4uZG9jdW1lbnQ7XG4gICAgaWYgKHByb3BzKSB7XG4gICAgICBjb25zdCB0cmlnZ2VyS2V5cyA9IHByb3BzLnRyaWdnZXJLZXlzO1xuICAgICAgY29uc3QgZGlzbWlzc0tleXMgPSBwcm9wcy5kaXNtaXNzS2V5cztcbiAgICAgIGlmICh0cmlnZ2VyS2V5cyA9PSBudWxsID8gdm9pZCAwIDogdHJpZ2dlcktleXMubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuX3RyaWdnZXJLZXlzID0gbmV3IFNldCh0cmlnZ2VyS2V5cyk7XG4gICAgICB9XG4gICAgICBpZiAoZGlzbWlzc0tleXMgPT0gbnVsbCA/IHZvaWQgMCA6IGRpc21pc3NLZXlzLmxlbmd0aCkge1xuICAgICAgICB0aGlzLl9kaXNtaXNzS2V5cyA9IG5ldyBTZXQoZGlzbWlzc0tleXMpO1xuICAgICAgfVxuICAgIH1cbiAgICBkb2MuYWRkRXZlbnRMaXN0ZW5lcihLRVlCT1JHX0ZPQ1VTSU4sIHRoaXMuX29uRm9jdXNJbiwgdHJ1ZSk7XG4gICAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5fb25Nb3VzZURvd24sIHRydWUpO1xuICAgIHdpbi5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9vbktleURvd24sIHRydWUpO1xuICAgIGRvYy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCB0aGlzLl9vbk1vdXNlT3JUb3VjaCwgdHJ1ZSk7XG4gICAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCB0aGlzLl9vbk1vdXNlT3JUb3VjaCwgdHJ1ZSk7XG4gICAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGNhbmNlbFwiLCB0aGlzLl9vbk1vdXNlT3JUb3VjaCwgdHJ1ZSk7XG4gICAgc2V0dXBGb2N1c0V2ZW50KHdpbik7XG4gIH1cbiAgZ2V0IGlzTmF2aWdhdGluZ1dpdGhLZXlib2FyZCgpIHtcbiAgICByZXR1cm4gdGhpcy5faXNOYXZpZ2F0aW5nV2l0aEtleWJvYXJkX0RPX05PVF9VU0U7XG4gIH1cbiAgc2V0IGlzTmF2aWdhdGluZ1dpdGhLZXlib2FyZCh2YWwpIHtcbiAgICBpZiAodGhpcy5faXNOYXZpZ2F0aW5nV2l0aEtleWJvYXJkX0RPX05PVF9VU0UgIT09IHZhbCkge1xuICAgICAgdGhpcy5faXNOYXZpZ2F0aW5nV2l0aEtleWJvYXJkX0RPX05PVF9VU0UgPSB2YWw7XG4gICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgIH1cbiAgfVxuICBkaXNwb3NlKCkge1xuICAgIGNvbnN0IHdpbiA9IHRoaXMuX3dpbjtcbiAgICBpZiAod2luKSB7XG4gICAgICBpZiAodGhpcy5faXNNb3VzZU9yVG91Y2hVc2VkVGltZXIpIHtcbiAgICAgICAgd2luLmNsZWFyVGltZW91dCh0aGlzLl9pc01vdXNlT3JUb3VjaFVzZWRUaW1lcik7XG4gICAgICAgIHRoaXMuX2lzTW91c2VPclRvdWNoVXNlZFRpbWVyID0gdm9pZCAwO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuX2Rpc21pc3NUaW1lcikge1xuICAgICAgICB3aW4uY2xlYXJUaW1lb3V0KHRoaXMuX2Rpc21pc3NUaW1lcik7XG4gICAgICAgIHRoaXMuX2Rpc21pc3NUaW1lciA9IHZvaWQgMDtcbiAgICAgIH1cbiAgICAgIGRpc3Bvc2VGb2N1c0V2ZW50KHdpbik7XG4gICAgICBjb25zdCBkb2MgPSB3aW4uZG9jdW1lbnQ7XG4gICAgICBkb2MucmVtb3ZlRXZlbnRMaXN0ZW5lcihLRVlCT1JHX0ZPQ1VTSU4sIHRoaXMuX29uRm9jdXNJbiwgdHJ1ZSk7XG4gICAgICBkb2MucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9vbk1vdXNlRG93biwgdHJ1ZSk7XG4gICAgICB3aW4ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5fb25LZXlEb3duLCB0cnVlKTtcbiAgICAgIGRvYy5yZW1vdmVFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCB0aGlzLl9vbk1vdXNlT3JUb3VjaCwgdHJ1ZSk7XG4gICAgICBkb2MucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsIHRoaXMuX29uTW91c2VPclRvdWNoLCB0cnVlKTtcbiAgICAgIGRvYy5yZW1vdmVFdmVudExpc3RlbmVyKFwidG91Y2hjYW5jZWxcIiwgdGhpcy5fb25Nb3VzZU9yVG91Y2gsIHRydWUpO1xuICAgICAgZGVsZXRlIHRoaXMuX3dpbjtcbiAgICB9XG4gIH1cbiAgaXNEaXNwb3NlZCgpIHtcbiAgICByZXR1cm4gISF0aGlzLl93aW47XG4gIH1cbiAgLyoqXG4gICAqIFVwZGF0ZXMgYWxsIGtleWJvcmcgaW5zdGFuY2VzIHdpdGggdGhlIGtleWJvYXJkIG5hdmlnYXRpb24gc3RhdGVcbiAgICovXG4gIHVwZGF0ZSgpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIGNvbnN0IGtleWJvcmdzID0gKF9iID0gKF9hID0gdGhpcy5fd2luKSA9PSBudWxsID8gdm9pZCAwIDogX2EuX19rZXlib3JnKSA9PSBudWxsID8gdm9pZCAwIDogX2IucmVmcztcbiAgICBpZiAoa2V5Ym9yZ3MpIHtcbiAgICAgIGZvciAoY29uc3QgaWQgb2YgT2JqZWN0LmtleXMoa2V5Ym9yZ3MpKSB7XG4gICAgICAgIEtleWJvcmcudXBkYXRlKGtleWJvcmdzW2lkXSwgdGhpcy5pc05hdmlnYXRpbmdXaXRoS2V5Ym9hcmQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICAvKipcbiAgICogQHJldHVybnMgd2hldGhlciB0aGUga2V5Ym9hcmQgZXZlbnQgc2hvdWxkIHRyaWdnZXIga2V5Ym9hcmQgbmF2aWdhdGlvbiBtb2RlXG4gICAqL1xuICBfc2hvdWxkVHJpZ2dlcktleWJvYXJkTmF2aWdhdGlvbihlKSB7XG4gICAgdmFyIF9hO1xuICAgIGlmIChlLmtleSA9PT0gXCJUYWJcIikge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGNvbnN0IGFjdGl2ZUVsZW1lbnQgPSAoX2EgPSB0aGlzLl93aW4pID09IG51bGwgPyB2b2lkIDAgOiBfYS5kb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICAgIGNvbnN0IGlzVHJpZ2dlcktleSA9ICF0aGlzLl90cmlnZ2VyS2V5cyB8fCB0aGlzLl90cmlnZ2VyS2V5cy5oYXMoZS5rZXlDb2RlKTtcbiAgICBjb25zdCBpc0VkaXRhYmxlID0gYWN0aXZlRWxlbWVudCAmJiAoYWN0aXZlRWxlbWVudC50YWdOYW1lID09PSBcIklOUFVUXCIgfHwgYWN0aXZlRWxlbWVudC50YWdOYW1lID09PSBcIlRFWFRBUkVBXCIgfHwgYWN0aXZlRWxlbWVudC5pc0NvbnRlbnRFZGl0YWJsZSk7XG4gICAgcmV0dXJuIGlzVHJpZ2dlcktleSAmJiAhaXNFZGl0YWJsZTtcbiAgfVxuICAvKipcbiAgICogQHJldHVybnMgd2hldGhlciB0aGUga2V5Ym9hcmQgZXZlbnQgc2hvdWxkIGRpc21pc3Mga2V5Ym9hcmQgbmF2aWdhdGlvbiBtb2RlXG4gICAqL1xuICBfc2hvdWxkRGlzbWlzc0tleWJvYXJkTmF2aWdhdGlvbihlKSB7XG4gICAgdmFyIF9hO1xuICAgIHJldHVybiAoX2EgPSB0aGlzLl9kaXNtaXNzS2V5cykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmhhcyhlLmtleUNvZGUpO1xuICB9XG4gIF9zY2hlZHVsZURpc21pc3MoKSB7XG4gICAgY29uc3Qgd2luID0gdGhpcy5fd2luO1xuICAgIGlmICh3aW4pIHtcbiAgICAgIGlmICh0aGlzLl9kaXNtaXNzVGltZXIpIHtcbiAgICAgICAgd2luLmNsZWFyVGltZW91dCh0aGlzLl9kaXNtaXNzVGltZXIpO1xuICAgICAgICB0aGlzLl9kaXNtaXNzVGltZXIgPSB2b2lkIDA7XG4gICAgICB9XG4gICAgICBjb25zdCB3YXMgPSB3aW4uZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgICAgIHRoaXMuX2Rpc21pc3NUaW1lciA9IHdpbi5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdGhpcy5fZGlzbWlzc1RpbWVyID0gdm9pZCAwO1xuICAgICAgICBjb25zdCBjdXIgPSB3aW4uZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgICAgICAgaWYgKHdhcyAmJiBjdXIgJiYgd2FzID09PSBjdXIpIHtcbiAgICAgICAgICB0aGlzLmlzTmF2aWdhdGluZ1dpdGhLZXlib2FyZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9LCBfZGlzbWlzc1RpbWVvdXQpO1xuICAgIH1cbiAgfVxufTtcbnZhciBLZXlib3JnID0gY2xhc3MgX0tleWJvcmcge1xuICBjb25zdHJ1Y3Rvcih3aW4sIHByb3BzKSB7XG4gICAgdGhpcy5fY2IgPSBbXTtcbiAgICB0aGlzLl9pZCA9IFwia1wiICsgKytfbGFzdElkO1xuICAgIHRoaXMuX3dpbiA9IHdpbjtcbiAgICBjb25zdCBjdXJyZW50ID0gd2luLl9fa2V5Ym9yZztcbiAgICBpZiAoY3VycmVudCkge1xuICAgICAgdGhpcy5fY29yZSA9IGN1cnJlbnQuY29yZTtcbiAgICAgIGN1cnJlbnQucmVmc1t0aGlzLl9pZF0gPSB0aGlzO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9jb3JlID0gbmV3IEtleWJvcmdDb3JlKHdpbiwgcHJvcHMpO1xuICAgICAgd2luLl9fa2V5Ym9yZyA9IHtcbiAgICAgICAgY29yZTogdGhpcy5fY29yZSxcbiAgICAgICAgcmVmczogeyBbdGhpcy5faWRdOiB0aGlzIH1cbiAgICAgIH07XG4gICAgfVxuICB9XG4gIHN0YXRpYyBjcmVhdGUod2luLCBwcm9wcykge1xuICAgIHJldHVybiBuZXcgX0tleWJvcmcod2luLCBwcm9wcyk7XG4gIH1cbiAgc3RhdGljIGRpc3Bvc2UoaW5zdGFuY2UpIHtcbiAgICBpbnN0YW5jZS5kaXNwb3NlKCk7XG4gIH1cbiAgLyoqXG4gICAqIFVwZGF0ZXMgYWxsIHN1YnNjcmliZWQgY2FsbGJhY2tzIHdpdGggdGhlIGtleWJvYXJkIG5hdmlnYXRpb24gc3RhdGVcbiAgICovXG4gIHN0YXRpYyB1cGRhdGUoaW5zdGFuY2UsIGlzTmF2aWdhdGluZ1dpdGhLZXlib2FyZCkge1xuICAgIGluc3RhbmNlLl9jYi5mb3JFYWNoKChjYWxsYmFjaykgPT4gY2FsbGJhY2soaXNOYXZpZ2F0aW5nV2l0aEtleWJvYXJkKSk7XG4gIH1cbiAgZGlzcG9zZSgpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgY3VycmVudCA9IChfYSA9IHRoaXMuX3dpbikgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLl9fa2V5Ym9yZztcbiAgICBpZiAoY3VycmVudCA9PSBudWxsID8gdm9pZCAwIDogY3VycmVudC5yZWZzW3RoaXMuX2lkXSkge1xuICAgICAgZGVsZXRlIGN1cnJlbnQucmVmc1t0aGlzLl9pZF07XG4gICAgICBpZiAoT2JqZWN0LmtleXMoY3VycmVudC5yZWZzKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY3VycmVudC5jb3JlLmRpc3Bvc2UoKTtcbiAgICAgICAgZGVsZXRlIHRoaXMuX3dpbi5fX2tleWJvcmc7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgIGBLZXlib3JnIGluc3RhbmNlICR7dGhpcy5faWR9IGlzIGJlaW5nIGRpc3Bvc2VkIGluY29ycmVjdGx5LmBcbiAgICAgICk7XG4gICAgfVxuICAgIHRoaXMuX2NiID0gW107XG4gICAgZGVsZXRlIHRoaXMuX2NvcmU7XG4gICAgZGVsZXRlIHRoaXMuX3dpbjtcbiAgfVxuICAvKipcbiAgICogQHJldHVybnMgV2hldGhlciB0aGUgdXNlciBpcyBuYXZpZ2F0aW5nIHdpdGgga2V5Ym9hcmRcbiAgICovXG4gIGlzTmF2aWdhdGluZ1dpdGhLZXlib2FyZCgpIHtcbiAgICB2YXIgX2E7XG4gICAgcmV0dXJuICEhKChfYSA9IHRoaXMuX2NvcmUpID09IG51bGwgPyB2b2lkIDAgOiBfYS5pc05hdmlnYXRpbmdXaXRoS2V5Ym9hcmQpO1xuICB9XG4gIC8qKlxuICAgKiBAcGFyYW0gY2FsbGJhY2sgLSBDYWxsZWQgd2hlbiB0aGUga2V5Ym9hcmQgbmF2aWdhdGlvbiBzdGF0ZSBjaGFuZ2VzXG4gICAqL1xuICBzdWJzY3JpYmUoY2FsbGJhY2spIHtcbiAgICB0aGlzLl9jYi5wdXNoKGNhbGxiYWNrKTtcbiAgfVxuICAvKipcbiAgICogQHBhcmFtIGNhbGxiYWNrIC0gUmVnaXN0ZXJlZCB3aXRoIHN1YnNjcmliZVxuICAgKi9cbiAgdW5zdWJzY3JpYmUoY2FsbGJhY2spIHtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuX2NiLmluZGV4T2YoY2FsbGJhY2spO1xuICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICB0aGlzLl9jYi5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogTWFudWFsbHkgc2V0IHRoZSBrZXlib2FyZCBuYXZpZ3Rpb24gc3RhdGVcbiAgICovXG4gIHNldFZhbChpc05hdmlnYXRpbmdXaXRoS2V5Ym9hcmQpIHtcbiAgICBpZiAodGhpcy5fY29yZSkge1xuICAgICAgdGhpcy5fY29yZS5pc05hdmlnYXRpbmdXaXRoS2V5Ym9hcmQgPSBpc05hdmlnYXRpbmdXaXRoS2V5Ym9hcmQ7XG4gICAgfVxuICB9XG59O1xuZnVuY3Rpb24gY3JlYXRlS2V5Ym9yZyh3aW4sIHByb3BzKSB7XG4gIHJldHVybiBLZXlib3JnLmNyZWF0ZSh3aW4sIHByb3BzKTtcbn1cbmZ1bmN0aW9uIGRpc3Bvc2VLZXlib3JnKGluc3RhbmNlKSB7XG4gIEtleWJvcmcuZGlzcG9zZShpbnN0YW5jZSk7XG59XG5cbi8vIHNyYy9pbmRleC50c1xudmFyIHZlcnNpb24gPSBcIjIuNi4wXCI7XG5leHBvcnQge1xuICBLRVlCT1JHX0ZPQ1VTSU4sXG4gIEtFWUJPUkdfRk9DVVNPVVQsXG4gIGNyZWF0ZUtleWJvcmcsXG4gIGRpc3Bvc2VLZXlib3JnLFxuICBnZXRMYXN0Rm9jdXNlZFByb2dyYW1tYXRpY2FsbHksXG4gIG5hdGl2ZUZvY3VzLFxuICB2ZXJzaW9uXG59O1xuLyohXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cbiAqL1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/keyborg/dist/esm/index.js\n");

/***/ })

};
;